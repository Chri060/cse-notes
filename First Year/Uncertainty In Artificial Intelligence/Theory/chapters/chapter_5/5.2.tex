\section{Probabilistic reasoning}

Graphical models are employed to depict the factorization of joint distributions. 
These models primarily facilitate backward reasoning, relying on Bayes' theorem. 
When it comes to computing probabilities, graph-based algorithms play a pivotal role. 
These algorithms operate on three main types of graphs: directed, undirected, and factor graphs.
\begin{example}
    A perplexing murder has transpired, with two potential culprits in the spotlight: the butler and the cook. 
    The arsenal of potential murder weapons comprises a butcher's knife, a pistol, and a fireplace poker.

    Taking into account the butler's lengthy, faithful service to the family and the cook's recent hiring, along with rumors of a questionable past, we can draw the following conclusions:
    \[\textnormal{P}(\textnormal{Culprit}\rightarrow butler)=20\% \:\:\:\:\:\:\:\:\:\:\:\: \textnormal{P}(\textnormal{Culprit}\rightarrow cook)=80\%\]
    The culprit is represented as a binary random variable, with probabilities that sum to 100$\%$.

    The butler, being ex-military, maintains a firearm securely stored in a locker drawer. 
    On the other hand, the cook has easy access to a plethora of knives. 
    Additionally, it's worth noting that the butler is aging and experiencing a decline in physical strength. 
    As for the available weapons:        
    \[\textnormal{Weapon}=\{pistol,knife,poker\}\]
    Based on the provided evidence, we can assert that:
    \[\textnormal{P}(\textnormal{Weapon}|\textnormal{Culprit}\rightarrow butler)=\begin{bmatrix} 80\% & 10\% & 10\% \end{bmatrix}\]
    \[\textnormal{P}(\textnormal{Weapon}|\textnormal{Culprit}\rightarrow cook)=\begin{bmatrix} 5\% & 65\% & 30\% \end{bmatrix}\]
    
    By applying the chain rule, we can ultimately calculate the joint distribution, which is as follows:
    \begin{table}[H]
        \centering
        \begin{tabular}{c|ccc|}
        \cline{2-4}
                                                & \textbf{pistol} & \textbf{knife} & \textbf{poker} \\ \hline
        \multicolumn{1}{|l|}{\textbf{cook}}   & $4\%$           & $52\%$         & $24\%$         \\
        \multicolumn{1}{|l|}{\textbf{butler}} & $16\%$          & $2\%$          & $2\%$          \\ \hline
        \end{tabular}
    \end{table}

    Employing the sum rule, we can determine the marginal distribution of culprits, with an 80$\%$ probability attributed to the cook and a 20$\%$ probability assigned to the butler. 
    Additionally, we can compute the marginal distribution of weapons: 20$\%$ for the pistol, 54$\%$ for the knife, and 26$\%$ for the poker.
    Should we come across the weapon at some point, we can leverage Bayes' theorem to ascertain the identity of the perpetrator.
\end{example}