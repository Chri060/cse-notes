\section{Exercise 1}

Consider the program be executed on a three-issue VLIW MIPS architecture with three fully pipelined functional units: 
\begin{itemize}
    \item Integer ALU with 1 cycle latency to next and 2 cycle latency to next branch. 
    \item Memory Unit with 3 cycle latency. 
    \item Floating Point Unit with 3 cycle latency.
\end{itemize}
Branch completed with one cycle delay slot.
Do not use neither software pipelining nor loop unrolling nor modifying loop indexes.
Consider the following code: 
\begin{verbnobox}[\verbarg]
FOR:    LD F2, VB(R6)
        FADD F3, F2, F6
        ST F3, VA(R7)
        LD F3, VC(R6)
        ST F3, VC(R7)
        FADD F4,F4,F3
        ADDI R6, R6, 4
        ADDI R7, R7, 4
        BLT R7, R8, FOR
\end{verbnobox}
\begin{enumerate}
    \item Identify all the conflicts. 
    \item Considering one iteration of the loop, schedule the assembly code for the VLIW machine in the following table by using the list-based scheduling.
\end{enumerate}

\subsection*{Solution}
\begin{enumerate}
    \item The hazards in the code are: 
        \begin{itemize}
            \item RAW F2 I1-I2.
            \item RAW F3 I2-I3.
            \item RAW F3 I4-I5.
            \item RAW F3 I4-I6.
            \item RAW R7 I8-I9.
            \item WAW F3 I2-I4.
            \item WAR R7 I8-I5.
            \item WAR R7 I8-I3.
            \item WAR R6 I7-I1.
            \item WAR R6 I7-I4.
            \item WAR F3 I3-I4.
            \item CNTRL.
        \end{itemize}
    \item The corresponding pipelined VLIW pipeline is the following: 
        \begin{table}[H]
            \centering
            \begin{tabular}{c|ccc}
            \textbf{Clock cycle} & \textbf{Integer ALU} & \textbf{Memory Unit} & \textbf{FPU}    \\ \hline
            1                    &                      & LD F2, VB(R6)        &                 \\
            2                    &                      &                      &                 \\
            3                    &                      &                      &                 \\
            4                    &                      &                      & FADD F3, F2, F6 \\
            5                    &                      &                      &                 \\
            6                    &                      &                      &                 \\
            \textit{7}           &                      & ST F3, VA(R7)        &                 \\
            \textit{8}           & ADDI R6, R6, 4       & LD F3, VC(R6)        &                 \\
            9                    &                      &                      &                 \\
            \textit{10}          &                      &                      &                 \\
            \textit{11}          & ADDI R7, R7, 4       & ST F3, VC(R7)        & FADD F4,F4,F3   \\
            \textit{12}          &                      &                      &                 \\
            \textit{13}          & BLT R7, R8, FOR      &                      &                 \\
            \textit{14}          & (branch delay slot)  &                      &                
            \end{tabular}
        \end{table}
\end{enumerate}