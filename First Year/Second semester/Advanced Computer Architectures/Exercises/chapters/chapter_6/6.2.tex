\section{Exercise 2}

Consider the program be executed on a three-issue VLIW architecture with three non-pipelined functional units:
\begin{itemize}
    \item Integer ALU with 1 cycle latency to and 2 cycle latency to next branch. 
    \item Memory Unit with 3 cycle latency. 
    \item Floating Point Unit with 3 cycle latency. 
\end{itemize}
Branch completed with 1 cycle delay slot. 
Do not use neither software pipelining nor loop unrolling nor modifying loop indexes.
Consider the following code: 
\begin{verbnobox}[\verbarg]
LW F2, A(F4)
ADDI F2, F2, 4
LW F3, B(F4)
ADDI F6, F2, -5
SUB F5, F4, F3
SW F5, C(F4)
ADDI F4, F4, 4
BNE F4, F7, L1
\end{verbnobox}
\begin{enumerate}
    \item Execute the pipelined VLIW pipeline. 
    \item Considering one iteration of the loop, schedule the assembly code for the VLIW machine in the following table by using the list-based scheduling.
\end{enumerate}

\subsection*{Solution}
\begin{enumerate}
    \item The corresponding pipelined VLIW pipeline is the following: 
        \begin{table}[H]
            \centering
            \begin{tabular}{c|ccc}
            \textbf{Clock cycle} & \textbf{Integer ALU} & \textbf{Memory Unit} & \textbf{FPU} \\ \hline
            1                    &                      & LW F2, A(F4)         &              \\
            2                    &                      &                      &              \\
            3                    &                      &                      &              \\
            4                    & ADDI F2, F2, 4       & LW F3, B(F4)         &              \\
            5                    & ADDI F6, F2, -5      &                      &              \\
            6                    &                      &                      &              \\
            \textit{7}           & SUB F5, F4, F3       &                      &              \\
            \textit{8}           & ADDI F4, F4, 4       & SW F5, C(F4)         &              \\
            9                    &                      &                      &              \\
            \textit{10}          & BNE F4, F7, L1       &                      &              \\
            \textit{11}          & (branch delay slot)  &                      &             
            \end{tabular}
        \end{table}
    \item The corresponding non-pipelined VLIW pipeline is the following: 
        \begin{table}[H]
            \centering
            \begin{tabular}{c|ccc}
            \textbf{Clock cycle} & \textbf{Integer ALU} & \textbf{Memory Unit} & \textbf{FPU} \\ \hline
            1                    &                      & LW F2, A(F4)         &              \\
            2                    &                      & LW F3, B(F4)         &              \\
            3                    &                      &                      &              \\
            4                    & ADDI F2, F2, 4       &                      &              \\
            5                    & ADDI F6, F2, -5      &                      &              \\
            6                    & SUB F5, F4, F3       &                      &              \\
            \textit{7}           & ADDI F4, F4, 4       & SW F5, C(F4)         &              \\
            \textit{8}           &                      &                      &              \\
            9                    & BNE F4, F7, L1       &                      &              \\
            \textit{10}          & (branch delay slot)  &                      &             
            \end{tabular}
        \end{table}
\end{enumerate}

