\section{Exercise 2}

Consider the following code: 
\begin{verbnobox}[\verbarg]
LD F1, 0(R1)
FADD F2, F2, F3
ADDI R3, R3, 8
LD F4, 0(R2)
FADD F5, F4, F2
FMULT F6, F1, F4
ADDI R5, R5, 1
LD R6, 0(R4)
SD F6, 0(R5)
SD F5, 0(R6)
\end{verbnobox}
We have: 
\begin{itemize}
    \item 3 Reservation Stations (RS1, RS2, RS3) with 3 Load Store unit (LDU1, LDU2, LDU3) with 3 clock cycles latency.
    \item 3 Reservation Stations (RS4, RS5, RS6) with 3 FPUs (FPU1, FPU2, FPU3) with 3 clock cycles latency.
    \item 2 Reservation Stations (RS7, RS8) with 1 Integer ALU ( ALU1) with 1 clock cycles latency. 
\end{itemize}
\begin{enumerate}
    \item Find all the conflicts. 
    \item Apply the Tomasulo algorithm. 
\end{enumerate}

\subsection*{Solution}
\begin{enumerate}
    \item The conflicts are the following: 
        \begin{itemize}
            \item RAW F0 I1-I6.
            \item RAW F2 I2-I5.
            \item RAW F4 I4-I5.
            \item RAW F4 I4-I6.
            \item RAW F6 I6-I9.
            \item RAW F5 I5-I10.
            \item RAW R5 I7-I9.
            \item RAW R6 I8-I10.
        \end{itemize}
    \item The final result of Tomasulo is: 
        \begin{table}[H]
            \centering
            \begin{tabular}{l|ccc|ccc}
            \multicolumn{1}{c|}{\textbf{Instruction}} & \textbf{Issue} & \textbf{Execution} & \textbf{Write} & \textbf{Hazards}                & \textbf{RS} & \textbf{Unit} \\ \hline
            \textit{LD F1, 0(R1)}                     & 1              & 2                  & 5              &                                 & RS1         & LDU1          \\
            \textit{FADD F2, F2, F3}                  & 2              & 3                  & 6              &                                 & RS4         & FPU1          \\
            \textit{ADDI R3, R3, 8}                   & 3              & 4                  & 7              & struct CDB                      & RS7         & ALU1          \\
            \textit{LD F4, 0(R2)}                     & 4              & 5                  & 8              &                                 & RS2         & LDU2          \\
            \textit{FADD F5, F4, F2}                  & 5              & 9                  & 12             & \makecell{RAW F4 \\ RAW F2}     & RS5         & FPU1          \\
            \textit{FMULT F6, F1, F4}                 & 6              & 9                  & 13             & \makecell{RAW F4 \\ struct CDB} & RS6         & FPU2          \\
            \textit{ADDI R5, R5, 1}                   & 7              & 8                  & 9              &                                 & RS8         & LDU1          \\
            \textit{LD R6, 0(R4)}                     & 8              & 9                  & 14             & struct CDB                      & RS1         & LDU1          \\
            \textit{SD F6, 0(R5)}                     & 9              & 14                 & 17             & RAW F6                          & RS2         & LDU2          \\
            \textit{SD F5, 0(R6)}                     & 10             & 15                 & 18             & \makecell{RAW F5 \\ RAW R6}     & RS3         & LDU1         
            \end{tabular}
        \end{table}
\end{enumerate}