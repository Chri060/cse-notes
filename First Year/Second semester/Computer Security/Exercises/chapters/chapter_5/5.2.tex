\section{Exercise 2}

Suppose that you are the network security administrator of the network 131.168.0.0/24, with gateway 131.168.0.1 and DNS servers 131.168.0.100 and 131.168.0.101. 
While examining the network activity, you notice a DHCP offer packet coming from IP 131.168.0.10 with gateway set to 131.168.0.5. 
Answer the following questions and provide a reason. 
Answers with no reason will not give any point.
\begin{enumerate}
    \item What kind of attack do you suspect, and how does it work?
    \item Why such an attack works?
    \item Can you tell the IP address of the host where those packets come from?
    \item Can you tell the IP address or network address of the victim?
\end{enumerate}

\subsection*{Solution}
\begin{enumerate}
    \item DHCP poisoning. Someone is trying to trick a client connected to 131.168.0.0/24 into believing that 131.168.0.5 is the gateway, by sending a crafted DHCP offer before, which comes before the real offer sent out by the real DHCP server.
    \item Because the DHCP protocol does not support authentication, so the client must blindly believe any DHCP offer that it sees, and because an arbitrary client can race (and win) against the real DHCP server
    \item Not really. 131.168.0.10 is the sender of the DHCP offer, but the address may be spoofed.
        We could look at the MAC address of the sender, but it could be spoofed as well.
    \item From the above information there is little evidence to say that, although the potential victims are those that will receive and accept the spoofed DHCP offers. 
        So, likely, 131.168.0.0/24
\end{enumerate}