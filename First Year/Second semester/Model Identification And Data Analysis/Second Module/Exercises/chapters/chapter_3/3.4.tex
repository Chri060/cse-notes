\section{Exercise four}

Consider the ARMAX system: 
\[y(t)=\dfrac{4}{1+\frac{1}{3}}u(t-1)+\dfrac{1+2z^{-1}}{\left(1+\frac{1}{2}z^{-1}\right)\left(1+\frac{1}{3}z^{-1}\right)}e(t) \qquad e(t)\sim WN(\mu,1)\]
\begin{enumerate}
    \item Check the assumptions for designing a Minimum Variance Controller.
    \item Compute the one-step ahead predictor.
    \item Compute the Minimum Variance Controller.
\end{enumerate}

\subsection*{Solution}
\begin{enumerate}
    \item The system in canonical form is:
        \[y(t)=\dfrac{4}{1+\frac{1}{3}}u(t-1)+\dfrac{1}{1+\frac{1}{3}z^{-1}}\eta(t) \qquad \eta(t)\sim WN(2\mu,4)\]
        The assumptions are:
        \begin{itemize}
            \item $b_0\neq 0$: $b_0=4$, satisfying the condition.
            \item $B(z)$ is minimum phase: both models have no roots, thus minimum phase.
            \item $\frac{C(z)}{A(z)}$ is in canonical form: both models are constructed in canonical form.
            \item We assume that $y^0(t)$ is independent of $e(t)$, and $y^0(t)$ is unpredictable. 
        \end{itemize}
    \item The one-step ahead predictor is given by:
        \[\hat{y}(t|t-1)=4u(t-1)-\dfrac{1}{3}y(t-1)+2\mu\]
        To find this predictor we have removed the mean from the process and the White Noise, and then added it again in the end. 
    \item To find the Minimum Variance Control for both systems, we do not use the formula since we have the bias term. 

        Starting with:
        \[\hat{y}(t|t-1)=4u(t-1)-\dfrac{1}{3}y(t-1)+2\mu\]
        We impose that $\hat{y}(t+k|t)=y^0(t)$: 
        \[y^0(t)=4u(t-1)-\dfrac{1}{3}y(t-1)+2\mu\]
        By isolating the the term $y^0(t)$, we obtain:
        \[u_(t)=\dfrac{1}{12}y(t)+\dfrac{1}{4}y^0(t)-\dfrac{1}{2}\mu\]
\end{enumerate}