\section{Exercise six}

Given the impulse response:
\[\omega(t)=\dfrac{4}{3}\left(-\dfrac{1}{3}\right)^t \qquad t\geq 0\]
We are tasked with:
\begin{enumerate}
    \item Determining if the data-generating system is stable and strictly proper.
    \item Finding the transfer function.
    \item Identifying the system matrices using the 4SID algorithm.
    \item Identifying the system matrices using the controllable canonical form.
\end{enumerate}

\subsubsection*{Solution}
\begin{enumerate}
    \item The system is asymptotically stable because as time tends to infinity, the impulse response tends to zero.
        Since $\omega(0)\neq 0$, the system is just proper and not strictly proper.
    \item We can rewrite the transfer function as:
        \[ W(z)=\sum_{t=0}^{+\infty}\omega(t)z^{-t}=\sum_{t=0}^{+\infty}\dfrac{4}{3}\left(-\dfrac{1}{3}\right)^tz^{-t}\]
        Using the geometric series formula, we get:
        \[W(z)=\dfrac{4}{3}\left(-\dfrac{1}{3}z^{-1}\right)^t=\dfrac{4}{3}\dfrac{1}{1+\frac{1}{3}z^{-1}}\]
    \item The 4SID method applies to proper systems for matrices $\hat{F}$, $\hat{G}$, and $\hat{H}$. 
        The only difference is that  $\hat{D}=\omega(0)$.
        The method involves the following steps:
        \begin{enumerate}
            \item Identify the order using the Hankel matrix:
                \[H_1=\begin{bmatrix} \omega(1) \end{bmatrix}=\begin{bmatrix} -\dfrac{1}{9} \end{bmatrix}\]
                Since the rank is one, proceed to $H_2$:
                \[H_2=\begin{bmatrix} \omega(1) & \omega(2) \\ \omega(2) & \omega(3) \end{bmatrix}=\begin{bmatrix} -\frac{4}{9} & \frac{4}{27} \\ \frac{4}{27} & -\frac{4}{81}\end{bmatrix}\]
                The rank is still one, indicating the system order is $n=1$. 
            \item Factorize $H_2=O_2R_2$. 
                \[R_2=H_2(1,:)=\begin{bmatrix} -\frac{4}{9} & \frac{4}{27} \end{bmatrix}\]
                From the relation, also obtain:
                \[O_2=\begin{bmatrix} 1 \\ -\frac{1}{3} \end{bmatrix}\]
            \item Determine the matrices:
                \[\hat{G}=R_2(:,1)=\begin{bmatrix} -\frac{4}{9} \end{bmatrix}\]
                \[\hat{H}=O_2(1,:)=\begin{bmatrix} 1 \end{bmatrix}\]
                \[\hat{F}=O_2(1,:)^{-1}O_2(2,:)=\begin{bmatrix} -\frac{1}{3} \end{bmatrix}\]
                \[\hat{D}=\begin{bmatrix} \frac{4}{3} \end{bmatrix}\]
        \end{enumerate}
    \item Using the positive power transfer function, we have:
        \[W(z)=\dfrac{4}{3}\dfrac{z}{z+\frac{1}{3}}=\dfrac{\frac{4}{3}\left(z+\frac{1}{3}\right)-\frac{4}{3}\frac{1}{3}}{z+\frac{1}{3}}=\dfrac{4}{3}+\dfrac{-\frac{4}{9}}{z+\frac{1}{3}}\]
        From this expression, we identify the system matrices as:
        \[F=-\dfrac{1}{3} \qquad G=1 \qquad H=-\dfrac{4}{9} \qquad D=\dfrac{4}{3}\]
\end{enumerate}