\section{Exercise three}

Consider the ARMAX process described by the expression:
\[y(t)=\dfrac{1}{3}y(t-1)+u(t-1)+3e(t-1)+e(t-2)\qquad e(t)\sim WN(0,1)\]
Let's compute the one-step ahead predictor.

\subsection*{Solution}
The ARMAX process can be rewritten as:
\[y(t)=\dfrac{C(z)}{A(z)}e(t)+\dfrac{B(z)}{A(z)}u(t-1)=\dfrac{3z^{-1}+z^{-2}}{1-\frac{1}{3}z^{-1}}e(t)+\dfrac{1}{1-\frac{1}{3}z^{-1}}u(t-1)\]
The transfer function we consider is the one multiplied by the noise $e(t)$: 
\[W(z)=\dfrac{3z^{-1}+z^{-2}}{1-\frac{1}{3}z^{-1}}e(t)=\dfrac{3z+1}{z^2-\frac{1}{3}z}e(t)\]
By collecting $3z^{-1}$ at the numerator, we get:
\[W(z)=\dfrac{1+\frac{1}{3}z^{-1}}{1-\frac{1}{3}z^{-1}}\eta(t)\qquad \eta(t)\sim WN(0,9)\]

The canonical form of the full ARMAX is:
\[y(t)=\dfrac{1+\frac{1}{3}z^{-1}}{1-\frac{1}{3}z^{-1}}\eta(t)+\dfrac{1}{1-\frac{1}{3}z^{-1}}u(t-1)\]

The one-step ahead predictor for an ARMAX is:
\[\hat{y}(t|t-1)=\dfrac{F(z)}{C(z)}y(t)+\dfrac{B(z)E(z)}{C(z)}u(t-1)=\dfrac{\frac{2}{3}z^{-1}}{1+\frac{1}{3}z^{-1}}y(t)+\dfrac{1}{1+\frac{1}{3}z^{-1}}u(t-1)\]