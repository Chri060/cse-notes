\section{Exercise 10}

Consider an input defined as:
\[u(t)=1\]
With the following output:
\[y(t)=\begin{cases}
    1 \qquad t \text{ is odd} \\
    -1 \qquad t \text{ is even} 
\end{cases}\]
We have the data from $t=0$ to $t=15$. 
And the model: 
\[\mathcal{M}:y(t)=ay(t-1)+bu(t-1)+\xi(t)\]
Here $\xi(t)\sin WN(0,\lambda^2)$

Let's identify the parameter $\theta^\ast$. 

\subsection*{Solution}
\begin{enumerate}
    \item Compute the predictor: 
        \[\hat{y}(t|t-1)=ay(t-1)+bu(t-1)\]
    \item The cost function is: 
        \[\hat{J}_a=\dfrac{1}{15}\sum_{i=1}^{15}{\left(y(i)-\hat{y}(i|i-1)\right)}^2\]
    \item Apply the Least Squares formula.
        We can rewrite the model as:
        \[\mathcal{M}:y(t)=\theta^T\varphi(t)+\xi(t)\qquad \varphi(t)=\begin{bmatrix}y(t-1) \\ u(t-1) \end{bmatrix}\]
        In this way, the predictor becomes:
        \[\hat{y}(t|t-1)=\theta^T\varphi(t)\]
        At this point, we have:
        \[\hat{\theta}_{15}={\left[\sum_{i=1}^{15}\varphi(i){\varphi(i)}^T\right]}^{-1}+\left[\sum_{i=1}^{15}\varphi(i)y(i)\right]\]
    \item Compute the formula:
        \[\hat{\theta}_{15}={\left[\sum_{i=1}^{15}\begin{bmatrix}y(i-1) \\ u(i-1) \end{bmatrix}\begin{bmatrix}y(i-1) & u(i-1) \end{bmatrix}\right]}^{-1}+\left[\sum_{i=1}^{15}\begin{bmatrix}y(i-1) \\ u(i-1) \end{bmatrix}y(i)\right]\]
        We have:
        \begin{align*}
            \hat{\theta}_{15} &=\begin{bmatrix}
                                \sum_{i=1}^{15}{y(i-1)}^2=15 &  \sum_{i=1}^{15}y(i-1)u(i-1) \\
                                \sum_{i=1}^{15}u(i-1)y(i-1) & \sum_{i=1}^{15}{u(t-1)}^2
                            \end{bmatrix}^{-1} \begin{bmatrix}
                                \sum_{i=1}^{15}y(i-1)y(i) \\
                                \sum_{i=1}^{15}u(i-1)y(i)
                            \end{bmatrix} \\
                            &=\begin{bmatrix}
                                15 & 1 \\
                                1 & 15
                            \end{bmatrix}^{-1} \begin{bmatrix}
                                -15 \\
                                -1
                            \end{bmatrix}=\begin{bmatrix}
                                1 \\
                                0
                            \end{bmatrix}
        \end{align*}
\end{enumerate}