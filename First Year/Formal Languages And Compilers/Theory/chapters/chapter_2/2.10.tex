\section{Grammar normal forms and transformations}

Grammars normal forms constrain the rules without reducing the family of generated languages. 
They are useful for both proving properties and for language design. 

Let us see some transformations useful both to obtain an equivalent normal form and design the syntax analyzers.

\subsection*{Nonterminal expansion}
The expansion of a nonterminal is used to eliminate it from the rules where it appears. 
\begin{example}
    Consider the grammar: 
    \[
    \begin{cases}
        A \rightarrow \alpha B \gamma \\
        B \rightarrow \beta_1|\beta_2|\dots|\beta_n
    \end{cases}    
    \]
    With the expansion of the nonterminal $B$ we obtain: 
    \[A \rightarrow \alpha\beta_1\gamma|\alpha\beta_2\gamma|\dots|\alpha\beta_n\gamma\]
\end{example}

\subsection*{Elimination of the axiom from right parts}
It is always possible to obtain right part of rules as strings by simply introducing a new axiom $S_0$ and the rule $S_0 \rightarrow S$.

\subsection*{Normal form without nullable nonterminals}
A non-terminal A is nullable if it can derive the empty string. 

Consider the set Null $\subseteq V$ of nullable non-terminals. 
It is composed of the following logical clauses, to be applied until a fixed point is reached:
\[A \in \textnormal{Null} \implies
\begin{cases}
    (A \rightarrow \varepsilon) \in P\\
    (A \rightarrow A_1A_2\dots A_n) \in P \:\:\:\:\:\: \textnormal{with } A_i \in V \backslash \{A\} \\
    \forall 1 \leq i \leq n \:\:\:\:\:\: \textnormal{with } A_i \in \textnormal{Null}
\end{cases}    
\]
The construction of the non-nullable form consist in:
\begin{enumerate}
    \item Compute the Null set. 
    \item For each rule within $P$ add as alternatives those obtained by deleting, in the right part, the nullable non-terminals. 
    \item Remove all empty rules, except for $A=S$. 
    \item Clean the grammar and remove any circularity. 
\end{enumerate}
The normal form without nullable nonterminals needs that no nonterminal other than the axiom is nullable. 
In that case the axiom is nullable only if the empty string $\varepsilon$ is in the language. 

















\subsection*{Copy rules and their elimination}
The copy rules are used to factorize common parts, and they reduce the size of the grammar. 
However, copy elimination shortens derivations and reduces the height of the syntax trees. 

The typical trade off is to define Copy$(A)\subseteq V$ set on nonterminal into which the nonterminal $A$ can be copied, possibly transitively:
\[\textnormal{Copy}(A)=\{B \in V | \textnormal{there exists a derivation } A \implies B\}\]

To eliminate the copy rules we have to: 
\begin{enumerate}
    \item Computation of Copy (assume a grammar with non-empty rules) by applying logical clauses until a fixed point is reached. 
        That is the reflexive transitive closure of the copy relation defined by the copy rules: 
        \[C \in \textnormal{Copy}(A) \textnormal{ if } (B \in \textnormal{Copy}(A)) \land (B \rightarrow C \in P)\]
    \item Definition of the rules of a grammar $G^{'}$, equivalent to $G$ but without copy rules.
        We remove the copy rules: 
        \[P^{'}:=P \backslash \{A \rightarrow B|A,B \in V\}\]
        And we add the compensating rules: 
        \[P^{'}:=P^{'}\cup\{A \rightarrow \alpha|\exists B (B \in \textnormal{Copy}(A) \land (B \rightarrow \alpha) \in P)\}\]
        The set of rule may increase considerably in size. 
\end{enumerate}

\subsection*{Conversion of left recursion to right recursion}
Grammars with no left recursion are necessary for designing top-down parser. 

To change from left recursion to right recursion we can have multiple possibility. 
The main case is the conversion of immediate left recursion: 
\[
\begin{cases}
    A \rightarrow A\beta_1|A\beta_2|\dots|A\beta_n \\
    A \rightarrow \gamma_1|\gamma_2|\dots|\gamma_k
\end{cases}    
\]
Where $\beta_i \neq \varepsilon \: \forall i$. We can transform this grammar into: 
\[
\begin{cases}
    A \rightarrow A^{'}\gamma_1|A^{'}\gamma_2|\dots|A^{'}\gamma_k|\gamma_1|\gamma_2|\dots|\gamma_k  \\
    A^{'} \rightarrow A^{'}\beta_1|A^{'}\beta_2|\dots|A^{'}\beta_h|\beta_1|\beta_2|\dots|\beta_h
\end{cases}    
\]
In this grammar we have right recursion since the string is generated from the left. 

\subsection*{Chomsky normal form}
The Chomsky normal form consist of two types of rules: 
\begin{enumerate}
    \item Homogeneous binary rules: $A \rightarrow BC$ with $B,C \in V$. 
    \item Terminal rules with singleton right part: $A \rightarrow a$ with $a \in \Sigma$.
\end{enumerate}
Syntax tree of this form have internal nodes of degree two and leaf parent nodes of degree one. 
The procedure to obtain the Chomsky normal form from a grammar $G$ is as follows: 
\begin{itemize}
    \item If the language contains the empty string, add the rule: $S \rightarrow \varepsilon$. 
    \item Then apply iteratively the following process: 
        \begin{itemize}
            \item For each rule type $A_0 \rightarrow A_1A_2\dots A_n$. 
            \item Add the rule type $A \rightarrow \left\langle A_1 \right\rangle\left\langle A_2\dots A_n\right\rangle $. 
            \item And also another rule $\left\langle A_2\dots A_n\right\rangle \rightarrow A_2\dots A_n$. 
        \end{itemize}
        After some iterations $A$ will be terminal, which means that we obtain $\left\langle A_1 \right\rangle\rightarrow A_1$. 
\end{itemize}

\subsection*{Real-time normal form}
In the real-time normal form we have that the right part of any rule has a terminal symbol as a prefix: 
\[A \rightarrow a \alpha \textnormal{ with } a \in \Sigma, \alpha \in \{\Sigma \cup V\}^{*}\]
The name of this form derives from a property of a syntax analysis: every step reads and consumes one terminal symbol. 
With this normal form we have that the number of steps for the analysis is proportional to the length of the string.

\subsection*{Greibach normal form}
In the Greibach normal form we have that every right part consists of a terminal followed by zero or more nonterminals: 
\[A \rightarrow a \alpha \textnormal{ with } a \in \Sigma, \alpha \in V^{*}\]