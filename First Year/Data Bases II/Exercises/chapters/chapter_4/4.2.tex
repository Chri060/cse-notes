\section{Ranking and skyline queries}

Consider the following three ranked lists reporting statistics about European soccer teams: 
\begin{table}[H]
    \centering
    \begin{tabular}{|cc|cc|cc|}
    \hline
    \textbf{Goals} & \textbf{Team} & \textbf{Possession} & \textbf{Team} & \textbf{Passes} & \textbf{Team} \\ \hline
    75         & PSG      & 63.2         & BMU      & 89.9         & PSG      \\
    73         & BMU      & 62.1         & BAR      & 88.9         & MCY      \\
    70         & ATA      & 61.8         & PSG      & 88.4         & BAR      \\
    68         & MCY      & 61.6         & MCY      & 87.5         & BMU      \\
    68         & BDO      & 59.0         & LIV      & 86.6         & BDO      \\
    66         & LIV      & 58.5         & BDO      & 84.4         & LAZ      \\
    63         & BAR      & 55.7         & ATA      & 83.9         & LIV      \\
    60         & LAZ      & 50.1         & LAZ      & 83.4         & ATA      \\ \hline
    \end{tabular}
\end{table}
\begin{enumerate}
    \item Apply an algorithm that does not use random access to determine the best team according to the scoring function:
        \[S(\textnormal{team})=\max\{\textnormal{team.Goals},\textnormal{team.Possession},\textnormal{team.Passes}\}\]
    \item On this dataset, could you do better than the previous algorithm, in terms of access cost, with an algorithm that also uses random access? 
    \item Apply now the TA to determine the best team according to the same scoring function as in one. 
    \item Apply now the TA to determine the best team according to the following scoring function:
        \[S(\textnormal{team}) = \textnormal{team.Goals} + \textnormal{team.Possession} + \textnormal{team.Passes}\]
    \item Determine the skyline of the dataset. 
\end{enumerate}

\paragraph*{Solution}
\begin{enumerate}
    \item Since the scoring function is MAX we can use the $B_0$ algorithm. Find the best team means that we have $k=1$, so we 
        need to make only one sorted access. By accessing the first row we obtain the following buffer. 
        \begin{table}[H]
            \centering
            \begin{tabular}{c|ccc|c}
            \hline
            \textbf{Player} & \textbf{Goals} & \textbf{Possession} & \textbf{Passes} & \textbf{Score} \\ \hline
            PSG             & 75             & ?                   & 89.9            & 89.9           \\
            BMU             & ?              & 63.2                & ?               & 0.8            \\ \hline
            \end{tabular}
        \end{table}
        The maximum score is given to PSG, that is the best team according to the MAX scoring function. 
    \item No algorithm could do better than reading at least the top scores on each list. 
    \item We have again $k=1$. We make a sorted access to the first row to compute the threshold value and 
        the objects to insert in the buffer. 
        \begin{table}[H]
            \centering
            \begin{tabular}{c|ccc|c}
            \hline
            \textbf{Player} & \textbf{Goals} & \textbf{Possession} & \textbf{Passes} & \textbf{Score} \\ \hline
            PSG             & 75             & ?                   & 89.9            & 89.9           \\
            BMU             & ?              & 63.2                & ?               & 0.8            \\ \hline
            \end{tabular}
        \end{table}
        The threshold point has a value that is the MAX of the scores in the first row, that is $89.9$. We now make random 
        accesses to complete the data in the buffer (remember that the algorithm searches the missing data when it inserts a 
        new object in the buffer). 
        \begin{table}[H]
            \centering
            \begin{tabular}{c|ccc|c}
            \hline
            \textbf{Player} & \textbf{Goals} & \textbf{Possession} & \textbf{Passes} & \textbf{Score} \\ \hline
            PSG             & 75             & 61.8                & 89.9            & 89.9           \\ \hline
            \end{tabular}
        \end{table}
        Note that the passes for PSG are accessed before via random access, and later via sorted access. So at each iteration (except for 
        the third column) the algorithm makes a sorted access and two random accesses. Since the threshold has the same value as the score 
        of PSG, the algorithm halts and returns PSG as the best team. 
    \item We have to apply again TA with $k=1$, but with a different scoring function, so the result may change. The check for the 
        first row is the same as the previous point, except for the score.
        \begin{table}[H]
            \centering
            \begin{tabular}{c|ccc|c}
            \hline
            \textbf{Player} & \textbf{Goals} & \textbf{Possession} & \textbf{Passes} & \textbf{Score} \\ \hline
            PSG             & 75             & 61.8                & 89.9            & 226.7           \\ \hline
            \end{tabular}
        \end{table}
        The threshold is the sum of the values in the first row $228.1$. The threshold is greater than PSG score, so we need to make another 
        iteration. In the next row we find: BMU (223.7), BAR (213.5), and MCY (218.5). All these scores are lower than PSG one, so the buffer 
        remains the same. The threshold point has a value of $224$, that is less than PSG score, so the algorithm halts. The best team with 
        SUM is again PSG. 
    \item It is possible to represent the dataset in a graph with coordinates (Goals, Possession, Passes). By inspecting the ordered table we 
        add PSG to the window and all the other teams that are not dominated by it. The only teams not dominated by PSG are BMU and BAR. We have 
        found that the skyline of the dataset is composed by three teams: PSG, BMU, and BAR. 
\end{enumerate}